"use strict";!function(){var e=[],i=function(e,i){this.errors=[],this.field=e,this.length=i};i.prototype={stopSubmit:function(){this.errors.length>0&&e.push("invalid")},colorizeValid:function(){this.field.classList.remove("modal-feedback__invalid-field")},colorizeInvalid:function(){this.field.classList.add("modal-feedback__invalid-field")},cleanErrorMessage:function(){var e=this.field.id,i=t.querySelectorAll("#"+e+"+ p");Array.prototype.slice.call(i).forEach(function(e){e.textContent=""})},setErrorMessage:function(){this.cleanErrorMessage();var e=t.querySelector("#"+this.field.id+"+ p");if(this.errors.length>0){var i=this.errors,r=document.createDocumentFragment();i.forEach(function(e){var i=document.createElement("p");i.classList.add("modal-feedback__error"),i.innerHTML="*"+e,r.appendChild(i)}),e.appendChild(r)}},checkIfEmpty:function(){if(""===this.field.value||this.field.value.match(/^\s/))return this.errors.push("Поле не может быть пустым или начинаться с пробелов!"),!0},checkIfTooShort:function(){if(this.field.value.length<this.length)return this.errors.push("Поле не может быть короче "+this.length+" символов"),!0},checkPhonePattern:function(){if(!this.field.value.match(/((\+?7\s?\(?(9\d{2}|343)\)?)\s?\d{3}-?\s?\d{2}(-?\s?)\d{2})|((8\s?\(?(9\d{2}|343)\)?)\s?\d{3}-?\s?\d{2}(-?\s?)\d{2})/))return this.errors.push("Номер телефона должен начинаться с +79 или 89 или +7(343) или 8(343)"),!0},checkMailPattern:function(){if(!this.field.value.match(/\w+@\w+/))return this.errors.push("Адрес эл. почты должен состоять из латинских букв и символа @ образец: example@mail.ru"),!0},checkMessagePattern:function(){if(this.field.value.match(/<|>|\/|\\|<a>|<\/a>|<img>|\|/))return this.errors.push("Поле Сообщение не может содержать символы < > \\ / |, а также теги html-разметки"),!0},checkName:function(){var e=this.checkIfEmpty(this.field),i=this.checkIfTooShort(this.field,this.length);e||i?(this.setErrorMessage(),this.colorizeInvalid()):(this.colorizeValid(),this.cleanErrorMessage())},checkPhone:function(){var e=this.checkIfEmpty(this.field),i=this.checkPhonePattern(this.field),t=this.checkIfTooShort(this.field,this.length);e||i||t?(this.setErrorMessage(),this.colorizeInvalid()):(this.colorizeValid(),this.cleanErrorMessage())},checkMail:function(){var e=this.checkIfEmpty(this.field),i=this.checkMailPattern();e||i?(this.setErrorMessage(),this.colorizeInvalid()):(this.colorizeValid(),this.cleanErrorMessage())},checkMessage:function(){var e=this.checkMessagePattern(this.field),i=this.checkIfEmpty(this.field),t=this.checkIfTooShort(this.field,this.length);e||i||t?(this.setErrorMessage(),this.colorizeInvalid()):(this.colorizeValid(),this.cleanErrorMessage())}};var t=document.querySelector(".modal-feedback__form"),r=t.querySelector(".modal-feedback__form-submit"),s=(document.querySelector(".modal-feedback"),{phoneField:t.querySelector("input#feedback-tel"),messageField:t.querySelector("textarea#feedback-message"),nameField:t.querySelector("input#feedback-name"),mailField:t.querySelector("input#feedback-mail"),spamCheckField:t.querySelector("input#phone-check")});function c(){new i(s.nameField,3).checkName(),new i(s.phoneField,11).checkPhone(),new i(s.mailField).checkMail(),new i(s.messageField,15).checkMessage()}t.addEventListener("input",c),r.addEventListener("click",function(r){var c=new i(s.nameField,3);c.checkName(),c.stopSubmit();var a=new i(s.phoneField,11);a.checkPhone(),a.stopSubmit();var l=new i(s.mailField);l.checkMail(),l.stopSubmit();var o=new i(s.messageField,15);o.checkMessage(),o.stopSubmit(),0===e.length&&""===s.spamCheckField.value?t.submit():r.preventDefault(),e=[]}),document.querySelector(".modal-feedback__form-close").addEventListener("click",function(){var e=new i(s.nameField,3);e.cleanErrorMessage(),e.colorizeValid();var t=new i(s.phoneField,11);t.cleanErrorMessage(),t.colorizeValid();var r=new i(s.mailField);r.cleanErrorMessage(),r.colorizeValid();var c=new i(s.messageField,15);c.cleanErrorMessage(),c.colorizeValid()})}();